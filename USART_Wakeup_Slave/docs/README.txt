${ProjName}:
USART_Wakeup_Slave


Intended purpose:
To demonstrate low power mode wakeup of a slave lpc8xx, by its on-chip USART,
using externally generated USART activity by a master lpc8xx. 
Current consumption can be measured on the slave, if desired.

Typical low power mode currents at room temperature for a MAX slave board:
* If TARGET_RX on the MAX board is connected via solder-jumper to the LPC11U35, 
  the currents you measure may be higher than the following, which were measured
  at room temperature on one MAX board with the solder-jumper removed.
* Sleep mode        1.09 mA
* Deep Sleep mode   .208 mA
* Power-down mode   1.70 uA 



Functional description:
* The slave project is intended to run concurrently with project USART_Wakeup_Master, 
  using two interconnected lpc8xx Max boards, one each for master and slave.
  
* For the master project, user input/output is through the debug UART, which is configured in
  Serial.c. and chip_setup.h. Connect a terminal emulator to the appropriate VCOM or USB
  com port.
  
* The slave project communicates with the master via USART.
  
* When the master project runs, the user is prompted to enter '0', '1', or '2'
  to put the slave into Sleep, Deep-sleep, or Power-down mode, respectively.

* The slave board's target enters the low power mode selected, and is awakened by a USART transfer
  generated by the master board, when the user types 'Esc' after a prompt.

* 3 LEDs are configured to verify if the Slave actually entered the low power mode.
  The three LEDs (Green, Red and Blue) are turned ON at the beginning of the test.

  When Slave enters Sleep mode ('0' selected at Master side), Green LED goes off.
  When Slave enters Deep-sleep ('1' selected at Master side), Red LED goes off.
  When Slave enters Power-down mode ('2' selected at Master side), Blue LED goes off.

External connections:
* The master and slave boards must be connected as per the #defines in the main c files and the SWM settings:
  // SWM settings for USART1 (master board) ... connect to ... SWM settings for USART1 (slave board)
  // SCLK_PIN = U1_SCLK on master board     ... connect to ... SCLK_PIN = U1_SCLK on slave board
  // TXD_PIN = U1_TXD on master board       ... connect to ... RXD_PIN = U1_RXD on slave board


Program Flow (slave board):
* This example runs from the 12 MHz FRO generating a 12 MHz. main clock.


* main() routine
  1. Clocks are enabled, analog blocks are disabled, internal pull-ups and pull-downs are disabled, GPIOs are made outputs driving '1'. 
  
  2. The SWM is configured for U1_SCLK and U1_RXD.
  
  3. USART1 and its clocking are configured.
  
  4. USART1 RXREADY interrupt is enabled, USART1 interrupt is enabled as wakeup source, and code execution enters the main while(1) loop.
  
  5. When code execution receives handshake from the ISR, the requested low power mode is entered.
  
  6. The next USART1 data received will wake up the lpc8xx, and the process repeats.
 
  
This example runs from Flash. 


To run this code: 
  1. Program to flash
  2. Reset the master board
  3. Reset the slave board

Note: It may be necessary to power-cycle the board in order to regain control of the reset button after programming.




